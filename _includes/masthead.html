{% include base_path %}

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav" style="display: flex; justify-content: space-between; align-items: center;">
        <button><span class="navicon"></span></button>
        <ul class="visible-links">
          {%- assign url_prefix = page.url | slice: 0, 4 -%}
          {%- assign is_cn = false -%}
          {%- if url_prefix == '/zh/' -%}
          {%- assign is_cn = true -%}
          {%- endif -%}
          <li class="masthead__menu-item masthead__menu-item--lg persist {% if page.url == '/' or page.url == '/index.html' or page.url == '/zh/' %}selected{% endif %}">
            {%- if is_cn -%}
              <a href="{{ base_path }}/zh/">林昭润</a>
            {%- else -%}
              <a href="{{ base_path }}/">{{ site.title }}</a>
            {%- endif -%}
          </li>

          {%- assign lang_prefix = '' -%}
          {%- if is_cn -%}
            {%- assign lang_prefix = 'zh' -%}
          {%- endif -%}

          {% for link in site.data.navigation.main %}
            {% assign full_url = link.url %}

            {% unless link.url contains 'http' %}
                {% assign full_url = lang_prefix | append: link.url %}
            {% endunless %}

            {% assign display_title = link.title %}
            {% if is_cn %}
              {% case link.title %}
                {% when 'Publications' %}
                  {% assign display_title = '论文' %}
                {% when 'Projects' %}
                  {% assign display_title = '项目' %}
                {% when 'Job Experiences' %}
                  {% assign display_title = '工作经历' %}
                {% when 'Awards' %}
                  {% assign display_title = '奖项' %}
                {% when 'TAs' %}
                  {% assign display_title = '助教经历' %}
                {% when 'Blog' %}
                  {% assign display_title = '博客' %}
              {% endcase %}
            {% endif %}
          
            <li class="masthead__menu-item {% if page.url contains link.url and link.url != '/' %}selected{% endif %}">
              <a href="{{ full_url | relative_url }}">{{ display_title }}</a>
            </li>
          {% endfor %}
          
          <!-- Language Toggle -->
          {% if is_cn %}
            <li class="masthead__menu-item persist">
              <a href="{{ page.url | remove_first: '/zh' | relative_url }}">EN</a>
            </li>
          {% else %}
            <li class="masthead__menu-item persist">
              <a href="{{ 'zh' | append: page.url | relative_url }}">中</a>
            </li>
          {% endif %}
          
          <!-- Dark Mode Toggle -->
          <li id="theme-toggle" class="masthead__menu-item persist tail">
            <a role="button" aria-labelledby="theme-icon"><i id="theme-icon" class="fa-solid fa-sun" aria-hidden="true" title="toggle theme"></i></a>
          </li>
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>
